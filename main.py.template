import time
import hazelcast
from hazelcast.discovery import HazelcastCloudDiscovery
import os
import logging

from connection import client_config

logging.basicConfig(level=logging.INFO)


def entry_added(event):
    print("Entry added with key: %s, value: %s" % (event.key, event.value))

client = hazelcast.HazelcastClient(client_config)
my_map = client.get_map("{{ .MapName}}").blocking()
my_map.add_entry_listener(True, added_func=entry_added)

time.sleep(3000)

client.shutdown()

